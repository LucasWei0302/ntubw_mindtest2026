<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測驗結果</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root { --bg: #FFFBEB; --text: #5B4636; }
        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .result-card {
            background: white; border-radius: 30px;
            padding: 40px;
            /* 放大卡片最大寬度 */
            max-width: 800px;
            width: 100%;
            text-align: center;
            box-shadow: 0 15px 40px rgba(91, 70, 54, 0.15);
        }
        h1 { color: {{ result.color }}; margin: 10px 0 20px 0; font-size: 2rem; }

        /* 調整圖表容器大小與置中 */
        .chart-container {
            position: relative;
            height: 500px; /* 設定高度為 500px */
            width: 100%;
            margin: 30px auto; /* 上下留白並水平置中 */
        }

        .desc {
            background: #F9F9F9; padding: 25px; border-radius: 20px;
            text-align: justify; line-height: 1.8; color: #666; margin-bottom: 30px;
            font-size: 1.1rem;
        }
        .btn-restart {
            background-color: #5B4636; color: white; padding: 15px 50px;
            border-radius: 50px; text-decoration: none; display: inline-block;
            font-size: 1.2rem; transition: 0.3s;
        }
        .btn-restart:hover { opacity: 0.9; transform: translateY(-2px);}

        /* 手機版調整 */
        @media (max-width: 600px) {
            .chart-container { height: 350px; } /* 手機版圖表稍微小一點以免溢出 */
            .result-card { padding: 20px; }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="result-card">
        <h1>{{ result.title }}</h1>

        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>

        <div class="desc">{{ result.desc }}</div>
        <a href="{{ url_for('home') }}" class="btn-restart">再測一次</a>
    </div>

    <script>
        const scores = {
            '悲': {{ scores['悲'] }},
            '智': {{ scores['智'] }},
            '力': {{ scores['力'] }}
        };

        const ctx = document.getElementById('radarChart').getContext('2d');
        const radarChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['悲 (Compassion)', '智 (Wisdom)', '力 (Power)'],
                datasets: [{
                    label: '能力分佈',
                    data: [scores['悲'], scores['智'], scores['力']],
                    backgroundColor: '{{ result.color }}33', // 使用結果顏色加上透明度 (hex 33 = 20% opacity)
                    borderColor: '{{ result.color }}',
                    pointBackgroundColor: '{{ result.color }}',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '{{ result.color }}',
                    borderWidth: 3,
                    pointRadius: 5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false, /* 關鍵：允許圖表不維持預設比例，填滿容器高度 */
                scales: {
                    r: {
                        angleLines: { display: true, color: '#e0e0e0' },
                        grid: { color: '#f0f0f0' },
                        suggestedMin: 0,
                        suggestedMax: 10,
                        pointLabels: {
                            font: { size: 16, family: "'Zen Maru Gothic', sans-serif", weight: 'bold' },
                            color: '#5B4636'
                        },
                        ticks: {
                            backdropColor: 'transparent', // 隱藏刻度背景
                            font: { size: 10 }
                        }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });
    </script>
</body>
</html>